<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Factor de Potencia - Electromatics</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css?v=3.0">
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        .sim-container {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        .controls-panel {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .chart-panel {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: relative;
            height: 500px;
        }

        .slider-group {
            margin-bottom: 25px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: 600;
            color: #ffffff;
            font-size: 15px;
        }

        .slider-value {
            color: var(--safety-orange);
            font-family: monospace;
            font-weight: 700;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            background: #2c3e50;
            border-radius: 5px;
            outline: none;
            appearance: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--safety-orange);
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.1s;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .control-buttons {
            display: flex;
            gap: 10px;
            margin-top: 30px;
        }

        .metric-card {
            background: rgba(255,255,255,0.05);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .metric-title {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .metric-val {
            font-weight: 700;
            font-family: monospace;
        }

        @media (max-width: 900px) {
            .sim-container {
                grid-template-columns: 1fr;
            }
            .chart-panel {
                height: 350px;
            }
        }
    </style>
</head>
<body>

    <header class="main-header">
        <nav class="container">
            <a href="index.html" class="logo">
                <img src="images/logo.png" alt="Electromatics Logo" style="height: 32px; margin-right: 10px; vertical-align: middle;">
                <span>Electromatics.com.ve</span>
            </a>
            <div class="desktop-nav">
                          <div class="nav-dropdown">
            <a class="dropdown-trigger" href="index.html">Inicio <i class="fa-solid fa-chevron-down" style="font-size: 10px; margin-left: 5px;"></i></a>
            <div class="dropdown-content">
              <a href="que-es-electromatics.html">Qué es</a>
              <a href="para-quien-es.html">Para quién</a>
            </div>
          </div>
                <a href="calculos-electricos.html">Cálculos</a>
                <a href="normativa-electrica.html">Normativa</a>
                <a href="simuladores.html" class="active">Simuladores</a>
          <a href="electronica.html">Electrónica</a>
                <a href="formacion.html">Formación</a>
                <a href="electro-info.html">Tecno-Info</a>
                <a href="museo.html">Museo</a>
                <a href="apu.html">Presupuestos</a>
                <a href="calculadora.html">App IA</a>
                <a href="#" id="login-btn" class="btn btn-primary" style="padding: 6px 16px; margin-left: 20px; font-size: 14px">Acceder</a>
            </div>
        </nav>
    </header>

    <main class="container" style="padding-top: 40px; padding-bottom: 80px;">
        <a href="simuladores.html" style="color: var(--text-secondary); text-decoration: none; display: inline-flex; align-items: center; margin-bottom: 20px;">
            <i class="fa-solid fa-arrow-left" style="margin-right: 8px;"></i> Volver al Laboratorio
        </a>

        <div class="section-title">
            <h1 class="text-gradient-brand">Corrección de Factor de Potencia</h1>
            <p>Visualiza cómo los bancos de capacitores reducen la potencia reactiva y mejoran la eficiencia.</p>
        </div>

        <div class="sim-container">
            <!-- Controls -->
            <div class="controls-panel">
                <h3 style="margin-bottom: 20px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">Carga Inductiva</h3>
                
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Potencia Activa (P) [kW]</span>
                        <span id="val-p" class="slider-value">50</span>
                    </div>
                    <input type="range" id="p_kw" min="10" max="100" step="1" value="50">
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <span>F.P. Inicial (Inductivo)</span>
                        <span id="val-fp-init" class="slider-value">0.70</span>
                    </div>
                    <input type="range" id="fp_init" min="0.50" max="0.95" step="0.01" value="0.70">
                </div>

                <h3 style="margin: 30px 0 15px 0; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">Compensación</h3>
                
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Banco Capacitores [kVAR]</span>
                        <span id="val-c" class="slider-value">0</span>
                    </div>
                    <input type="range" id="qc_kvar" min="0" max="100" step="1" value="0">
                </div>

                <h3 style="margin: 30px 0 15px 0; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">Resultados</h3>
                
                <div class="metric-card">
                    <span class="metric-title">F.P. Final</span>
                    <span id="metric-fp-new" class="metric-val" style="color: var(--electric-blue)">0.70</span>
                </div>
                <div class="metric-card">
                    <span class="metric-title">Potencia Aparente (S)</span>
                    <span id="metric-s-new" class="metric-val">71.4 kVA</span>
                </div>
                <div class="metric-card">
                    <span class="metric-title">Corriente Reducida</span>
                    <span id="metric-reduction" class="metric-val" style="color: #00E676">0%</span>
                </div>

                <div class="control-buttons">
                    <button id="reset-sim" class="btn btn-secondary full-width">
                        <i class="fa-solid fa-rotate-right"></i> Reiniciar
                    </button>
                </div>
            </div>

            <!-- Chart -->
            <div class="chart-panel">
                <canvas id="fpChart"></canvas>
            </div>
        </div>

        <!-- Theory Section -->
        <section style="margin-top: 50px; border-top: 1px solid var(--border-color); padding-top: 40px;">
            <h2 style="margin-bottom: 30px; font-size: 28px;">Teoría del <span style="color: var(--safety-orange);">Triángulo de Potencias</span></h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
                <!-- Conceptos -->
                <div>
                    <h3 style="color: var(--electric-blue); margin-bottom: 15px;">¿Qué es el Factor de Potencia?</h3>
                    <p style="color: var(--text-secondary); line-height: 1.7; margin-bottom: 20px;">
                        Es un indicador de la eficiencia con la que se utiliza la energía eléctrica. Se define como la relación entre la <strong>Potencia Activa (P)</strong> que realiza trabajo útil y la <strong>Potencia Aparente (S)</strong> total suministrada.
                    </p>

                    <div style="background: var(--card-bg); padding: 20px; border-radius: 8px; border-left: 4px solid var(--safety-orange);">
                        <h4 style="margin-bottom: 10px; color: var(--text-primary);">Fórmulas Clave</h4>
                        <p style="font-family: 'Courier New', monospace; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 4px; color: #fff; margin-bottom: 8px;">
                            FP = P / S = cos(φ)
                        </p>
                        <p style="font-family: 'Courier New', monospace; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 4px; color: #fff;">
                            S = √(P² + Q²)
                        </p>
                    </div>
                </div>

                <!-- Desglose de Potencias -->
                <div>
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #4CAF50; margin-bottom: 5px;"><i class="fa-solid fa-bolt" style="margin-right: 8px;"></i>P - Potencia Activa (kW)</h4>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                            Es la energía que realmente se convierte en trabajo útil (movimiento, luz, calor).
                        </p>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #FF5252; margin-bottom: 5px;"><i class="fa-solid fa-magnet" style="margin-right: 8px;"></i>Q - Potencia Reactiva (kVAR)</h4>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                            Es la energía necesaria para crear campos magnéticos (motores, transformadores). No produce trabajo útil pero ocupa capacidad en los cables.
                        </p>
                    </div>

                    <div>
                        <h4 style="color: #2196F3; margin-bottom: 5px;"><i class="fa-solid fa-plug" style="margin-right: 8px;"></i>S - Potencia Aparente (kVA)</h4>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                            Es la suma vectorial de P y Q. Es la capacidad total que debe tener el transformador y el cableado para alimentar la carga.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Response Types Section -->
        <section style="margin-top: 50px; border-top: 1px solid var(--border-color); padding-top: 40px;">
            <h2 style="margin-bottom: 30px; font-size: 24px;">Estados de Compensación</h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                <!-- Inductivo -->
                <div style="background: var(--card-bg); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color);">
                    <div style="height: 220px; background: #1e293b; display: flex; align-items: center; justify-content: center; padding: 20px;">
                        <!-- SVG Inductive: Large Q Down -->
                        <svg width="200" height="150" viewBox="0 0 200 150">
                            <!-- P (Active) -->
                            <line x1="20" y1="20" x2="180" y2="20" stroke="#4CAF50" stroke-width="4" marker-end="url(#arrow-green)"/>
                            <!-- Q (Inductive) -->
                            <line x1="180" y1="20" x2="180" y2="130" stroke="#FF5252" stroke-width="4" stroke-dasharray="5,5" marker-end="url(#arrow-red)"/>
                            <!-- S (Apparent) -->
                            <line x1="20" y1="20" x2="180" y2="130" stroke="#FFC107" stroke-width="4"/>
                            
                            <!-- Labels -->
                            <text x="100" y="15" fill="#4CAF50" text-anchor="middle" font-size="14" font-weight="bold">P</text>
                            <text x="190" y="80" fill="#FF5252" text-anchor="middle" font-size="14" font-weight="bold">Q</text>
                            <text x="80" y="90" fill="#FFC107" text-anchor="middle" font-size="14" font-weight="bold">S</text>

                            <!-- Defs for markers -->
                            <defs>
                                <marker id="arrow-green" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                    <path d="M0,0 L0,6 L9,3 z" fill="#4CAF50" />
                                </marker>
                                <marker id="arrow-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                    <path d="M0,0 L0,6 L9,3 z" fill="#FF5252" />
                                </marker>
                            </defs>
                        </svg>
                    </div>
                    <div style="padding: 20px;">
                        <h4 style="color: #FF5252; margin-bottom: 10px;">Bajo Factor de Potencia</h4>
                        <p style="font-size: 13px; color: #FF5252; line-height: 1.5;">
                            La corriente es muy alta para la misma potencia útil. Esto causa calentamiento en cables y multas por parte de la compañía eléctrica.
                        </p>
                    </div>
                </div>

                <!-- Corregido -->
                <div style="background: var(--card-bg); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color);">
                    <div style="height: 220px; background: #1e293b; display: flex; align-items: center; justify-content: center; padding: 20px;">
                        <!-- SVG Corrected: Small Q -->
                        <svg width="200" height="150" viewBox="0 0 200 150">
                            <!-- P (Active) -->
                            <line x1="20" y1="75" x2="180" y2="75" stroke="#4CAF50" stroke-width="4" marker-end="url(#arrow-green-2)"/>
                            <!-- Q (Net Small but visible) -->
                            <line x1="180" y1="75" x2="180" y2="125" stroke="#00E676" stroke-width="4" marker-end="url(#arrow-lime)"/>
                            <!-- S (Apparent - almost P) -->
                            <line x1="20" y1="75" x2="180" y2="125" stroke="#FFC107" stroke-width="4"/>

                            <!-- Labels -->
                            <text x="100" y="70" fill="#4CAF50" text-anchor="middle" font-size="14" font-weight="bold">P</text>
                            <text x="195" y="110" fill="#00E676" text-anchor="middle" font-size="12" font-weight="bold">Q</text>
                            
                            <defs>
                                <marker id="arrow-green-2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                    <path d="M0,0 L0,6 L9,3 z" fill="#4CAF50" />
                                </marker>
                                <marker id="arrow-lime" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                    <path d="M0,0 L0,6 L9,3 z" fill="#00E676" />
                                </marker>
                            </defs>
                        </svg>
                    </div>
                    <div style="padding: 20px;">
                        <h4 style="color: #00E676; margin-bottom: 10px;">Compensación Óptima</h4>
                        <p style="font-size: 13px; color: #00E676; line-height: 1.5;">
                            Al agregar capacitores, se anula parte de la reactiva inductiva. La corriente total disminuye y se libera capacidad del sistema.
                        </p>
                    </div>
                </div>

                <!-- Capacitivo -->
                <div style="background: var(--card-bg); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color);">
                    <div style="height: 220px; background: #1e293b; display: flex; align-items: center; justify-content: center; padding: 20px;">
                        <!-- SVG Capacitive: Q Up -->
                        <svg width="200" height="150" viewBox="0 0 200 150">
                            <!-- P (Active) -->
                            <line x1="20" y1="130" x2="180" y2="130" stroke="#4CAF50" stroke-width="4" marker-end="url(#arrow-green-3)"/>
                            <!-- Q (Capacitive - Up) -->
                            <line x1="180" y1="130" x2="180" y2="60" stroke="#448aff" stroke-width="4" marker-end="url(#arrow-blue)"/>
                            <!-- S (Apparent) -->
                            <line x1="20" y1="130" x2="180" y2="60" stroke="#FFC107" stroke-width="4"/>

                            <!-- Labels -->
                            <text x="100" y="145" fill="#4CAF50" text-anchor="middle" font-size="14" font-weight="bold">P</text>
                            <text x="190" y="100" fill="#448aff" text-anchor="middle" font-size="14" font-weight="bold">Q</text>
                             <text x="80" y="80" fill="#FFC107" text-anchor="middle" font-size="14" font-weight="bold">S</text>

                            <defs>
                                <marker id="arrow-green-3" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                    <path d="M0,0 L0,6 L9,3 z" fill="#4CAF50" />
                                </marker>
                                <marker id="arrow-blue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                    <path d="M0,0 L0,6 L9,3 z" fill="#448aff" />
                                </marker>
                            </defs>
                        </svg>
                    </div>
                    <div style="padding: 20px;">
                        <h4 style="color: #448aff; margin-bottom: 10px;">Sobrecompensado</h4>
                        <p style="font-size: 13px; color: #448aff; line-height: 1.5;">
                            Agregar demasiados capacitores vuelve el sistema capacitivo (FP en adelanto). Esto puede elevar peligrosamente la tensión de la red.
                        </p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        <div class="container">
          <div class="footer-content">
            <div class="footer-info">
              <h3>Electromatics.com.ve</h3>
              <p>Innovación en Ingeniería Eléctrica y Automatización.</p>
              <div style="margin-top: 20px">
                <a href="https://youtube.com/@leonelgarcia4464" target="_blank" style="margin-right: 15px; font-size: 20px; color: #FF0000;"
                  ><i class="fa-brands fa-youtube"></i
                ></a>
                <a href="https://wa.me/5841658371322" target="_blank" style="margin-right: 15px; font-size: 20px; color: #25D366;"
                  ><i class="fa-brands fa-whatsapp"></i
                ></a>
                <a href="https://tiktok.com/@electrum69" target="_blank" style="margin-right: 15px; font-size: 20px; color: #000000;"
                  ><i class="fa-brands fa-tiktok"></i
                ></a>
                <a href="https://www.linkedin.com/in/leonel-garcía-0a1293b6" target="_blank" style="font-size: 20px; color: #0077b5;"
                  ><i class="fa-brands fa-linkedin"></i
                ></a>
              </div>
            </div>
            <div class="footer-links">
                <h4>Plataforma</h4>
                <a href="calculadora.html">Calculadora IA</a>
                <a href="normativa-electrica.html">Normativa 200-2009</a>
                <a href="uso-responsable-ia.html">Uso Responsable IA</a>
                <a href="formacion.html">Formación Técnica</a>
                <a href="proyectos.html">Proyectos</a>
            </div>
            <div class="footer-links">
                <h4>Empresa</h4>
                <a href="que-es-electromatics.html">Qué es Electromatics</a>
                <a href="para-quien-es.html">Para quién es</a>
                <a href="calculos-electricos.html">Servicios de Cálculo</a>
                <a href="contacto.html">Contacto</a>
            </div>
          </div>
          <div class="footer-bottom">
            <p style="margin-bottom: 10px; color: var(--text-secondary); opacity: 0.8; font-size: 14px;">
                Electromatics es una plataforma de apoyo al cálculo eléctrico. La responsabilidad técnica del uso de la información corresponde al usuario.
            </p>
            <p>&copy; 2025 Electromatics.com.ve. Todos los derechos reservados.</p>
          </div>
        </div>
    </footer>

    <script src="js/config.js"></script>
    <script src="js/simple-auth.js"></script>
    <script src="js/simulator-auth.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
             SimulatorAuth.init();
        });
    </script>
    <script src="js/simulators/power-factor.js?v=1.0"></script>
    <script src="js/premium-interactions.js?v=1.0"></script>
</body>
</html>
