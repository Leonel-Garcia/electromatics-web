<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador PID - Electromatics</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css?v=3.0">
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        .sim-container {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        .controls-panel {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .chart-panel {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: relative;
            height: 500px;
        }

        .slider-group {
            margin-bottom: 25px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: 600;
            color: #ffffff;
            font-size: 15px;
        }

        .slider-value {
            color: var(--safety-orange);
            font-family: monospace;
            font-weight: 700;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            background: #2c3e50;
            border-radius: 5px;
            outline: none;
            appearance: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--safety-orange);
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.1s;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .control-buttons {
            display: flex;
            gap: 10px;
            margin-top: 30px;
        }

        .metric-card {
            background: rgba(255,255,255,0.05);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .metric-title {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .metric-val {
            font-weight: 700;
            font-family: monospace;
        }

        @media (max-width: 900px) {
            .sim-container {
                grid-template-columns: 1fr;
            }
            .chart-panel {
                height: 350px;
            }
        }
    </style>
</head>
<body>

    <header class="main-header">
        <nav class="container">
            <a href="index.html" class="logo">
                <img src="images/logo.png" alt="Electromatics Logo" style="height: 32px; margin-right: 10px; vertical-align: middle;">
                <span>Electromatics.com.ve</span>
            </a>
            <div class="desktop-nav">
                <a href="index.html">Inicio</a>
                <a href="que-es-electromatics.html">Qué es</a>
                <a href="para-quien-es.html">Para quién</a>
                <a href="calculos-electricos.html">Cálculos</a>
                <a href="normativa-electrica.html">Normativa</a>
                <a href="simuladores.html" class="active">Simuladores</a>
                <a href="formacion.html">Formación</a>
                <a href="electro-info.html">Tecno-Info</a>
                <a href="apu.html">Presupuestos</a>
                <a href="calculadora.html">App IA</a>
                <a href="#" id="login-btn" class="btn btn-primary" style="padding: 6px 16px; margin-left: 20px; font-size: 14px">Acceder</a>
            </div>
        </nav>
    </header>

    <main class="container" style="padding-top: 40px; padding-bottom: 80px;">
        <a href="simuladores.html" style="color: var(--text-secondary); text-decoration: none; display: inline-flex; align-items: center; margin-bottom: 20px;">
            <i class="fa-solid fa-arrow-left" style="margin-right: 8px;"></i> Volver al Laboratorio
        </a>

        <div class="section-title">
            <h1>Simulador de Control <span style="color: var(--safety-orange);">PID</span></h1>
            <p>Ajusta las ganancias para controlar la respuesta de un sistema de segundo orden.</p>
        </div>

        <div class="sim-container">
            <!-- Controls -->
            <div class="controls-panel">
                <h3 style="margin-bottom: 20px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">Parámetros</h3>
                
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Ganancia Proporcional (Kp)</span>
                        <span id="val-kp" class="slider-value">1.00</span>
                    </div>
                    <input type="range" id="kp" min="0" max="100" step="0.1" value="1.0">
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <span>Ganancia Integral (Ki)</span>
                        <span id="val-ki" class="slider-value">0.10</span>
                    </div>
                    <input type="range" id="ki" min="0" max="50" step="0.01" value="0.1">
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <span>Ganancia Derivativa (Kd)</span>
                        <span id="val-kd" class="slider-value">0.50</span>
                    </div>
                    <input type="range" id="kd" min="0" max="50" step="0.1" value="0.5">
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <span>Setpoint (Referencia)</span>
                        <span id="val-sp" class="slider-value">50</span>
                    </div>
                    <input type="range" id="sp" min="0" max="100" step="1" value="50">
                </div>

                <h3 style="margin: 30px 0 15px 0; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">Estado</h3>
                
                <div class="metric-card">
                    <span class="metric-title">Error Actual</span>
                    <span id="metric-error" class="metric-val" style="color: #ff5252">0.00</span>
                </div>
                <div class="metric-card">
                    <span class="metric-title">Salida PID</span>
                    <span id="metric-output" class="metric-val" style="color: #448aff">0.00</span>
                </div>

                <h3 style="margin: 20px 0 15px 0; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">Desempeño</h3>
                
                <div style="background: linear-gradient(135deg, rgba(33,150,243,0.1), rgba(76,175,80,0.1)); padding: 15px; border-radius: 8px; border: 1px solid var(--electric-blue); margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span style="font-size: 13px; color: var(--text-secondary);">Sobrepaso:</span>
                        <span id="metric-overshoot" style="font-family: monospace; font-weight: 700; color: var(--safety-orange);">0.0%</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span style="font-size: 13px; color: var(--text-secondary);">T. Asentamiento:</span>
                        <span id="metric-settling" style="font-family: monospace; font-weight: 700; color: #4CAF50;">Aún no</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="font-size: 13px; color: var(--text-secondary);">Error Est. Estable:</span>
                        <span id="metric-sse" style="font-family: monospace; font-weight: 700; color: #ff5252;">0.00</span>
                    </div>
                    <p style="font-size: 11px; color: rgba(255,255,255,0.5); margin-top: 10px; margin-bottom: 0;">
                        <i class="fa-solid fa-info-circle"></i> T. Asentamiento: tiempo en ±2% del setpoint
                    </p>
                </div>

                <div class="control-buttons">
                    <button id="reset-sim" class="btn btn-secondary full-width">
                        <i class="fa-solid fa-rotate-right"></i> Reiniciar
                    </button>
                </div>
            </div>

            <!-- Chart -->
            <div class="chart-panel">
                <canvas id="pidChart"></canvas>
            </div>
        </div>

        <!-- Theory Section -->
        <section style="margin-top: 50px; border-top: 1px solid var(--border-color); padding-top: 40px;">
            <h2 style="margin-bottom: 30px; font-size: 28px;">Teoría del Control <span style="color: var(--safety-orange);">PID</span></h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
                <!-- Conceptos -->
                <div>
                    <h3 style="color: var(--electric-blue); margin-bottom: 15px;">¿Qué es un PID?</h3>
                    <p style="color: var(--text-secondary); line-height: 1.7; margin-bottom: 20px;">
                        Un controlador <strong>Proporcional-Integral-Derivativo (PID)</strong> es un mecanismo de control por realimentación ampliamente usado en sistemas de control industrial. El PID calcula continuamente un valor de error como la diferencia entre una variable de proceso deseada (Setpoint) y una variable de proceso medida (PV), y aplica una corrección basándose en términos proporcionales, integrales y derivativos.
                    </p>

                    <div style="background: var(--card-bg); padding: 20px; border-radius: 8px; border-left: 4px solid var(--safety-orange);">
                        <h4 style="margin-bottom: 10px; color: var(--text-primary);">La Ecuación de Control</h4>
                        <p style="font-family: 'Courier New', monospace; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 4px; color: #fff;">
                            u(t) = Kp·e(t) + Ki·∫e(t)dt + Kd·de(t)/dt
                        </p>
                        <p style="font-size: 13px; color: var(--text-secondary); margin-top: 10px;">
                            Donde <strong>u(t)</strong> es la salida del controlador y <strong>e(t)</strong> es el error (SP - PV).
                        </p>
                    </div>
                </div>

                <!-- Explicación de Términos -->
                <div>
                    <h3 style="color: var(--electric-blue); margin-bottom: 15px;">Desglose de Términos</h3>
                    
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #4CAF50; margin-bottom: 5px;"><i class="fa-solid fa-gauge-high" style="margin-right: 8px;"></i>P - Proporcional (Pasado)</h4>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                            Mira el <strong>error actual</strong>. Si el error es grande, la acción de control es grande. Es la fuerza bruta del controlador.
                            <br><em style="opacity: 0.7;">Efecto: Reduce el tiempo de subida, pero no elimina el error estacionario.</em>
                        </p>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #2196F3; margin-bottom: 5px;"><i class="fa-solid fa-clock-rotate-left" style="margin-right: 8px;"></i>I - Integral (Presente/Acumulado)</h4>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                            Mira el <strong>historial del error</strong>. Acumula el error en el tiempo para forzar al sistema a llegar al setpoint exacto.
                            <br><em style="opacity: 0.7;">Efecto: Elimina el error de estado estable, pero añade oscilaciones (overshoot).</em>
                        </p>
                    </div>

                    <div>
                        <h4 style="color: #FFC107; margin-bottom: 5px;"><i class="fa-solid fa-chart-line" style="margin-right: 8px;"></i>D - Derivativo (Futuro)</h4>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                            Predice el <strong>error futuro</strong> basándose en la velocidad de cambio. Actúa como un freno para evitar sobrepasos.
                            <br><em style="opacity: 0.7;">Efecto: Mejora la estabilidad y reduce el overshoot, pero es sensible al ruido.</em>
                        </p>
                    </div>
                </div>
            </div>
        </section>
        <!-- Response Types Section -->
        <section style="margin-top: 50px; border-top: 1px solid var(--border-color); padding-top: 40px;">
            <h2 style="margin-bottom: 30px; font-size: 24px;">Tipos de Respuesta Típicos</h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                <!-- Subamortiguado -->
                <div style="background: var(--card-bg); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color);">
                    <div style="height: 220px; overflow: hidden; background: white;">
                        <img src="images/simulators/pid_underdamped.png" alt="Respuesta Subamortiguada" style="width: 100%; height: 100%; object-fit: contain;">
                    </div>
                    <div style="padding: 20px;">
                        <h4 style="color: #448aff; margin-bottom: 10px;">Subamortiguado</h4>
                        <p style="font-size: 13px; color: #448aff; line-height: 1.5;">
                            El sistema reacciona muy rápido pero excede el setpoint (<strong>overshoot</strong>) y oscila antes de estabilizarse. Ocurre cuando la ganancia <strong>P</strong> es alta o <strong>D</strong> es baja.
                        </p>
                    </div>
                </div>

                <!-- Críticamente Amortiguado -->
                <div style="background: var(--card-bg); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color);">
                    <div style="height: 220px; overflow: hidden; background: white;">
                        <img src="images/simulators/pid_critical.png" alt="Respuesta Críticamente Amortiguada" style="width: 100%; height: 100%; object-fit: contain;">
                    </div>
                    <div style="padding: 20px;">
                        <h4 style="color: #00E676; margin-bottom: 10px;">Críticamente Amortiguado</h4>
                        <p style="font-size: 13px; color: #00E676; line-height: 1.5;">
                            La respuesta ideal. El sistema llega al setpoint lo más rápido posible sin oscilar. Es el equilibrio perfecto entre velocidad y estabilidad.
                        </p>
                    </div>
                </div>

                <!-- Sobreamortiguado -->
                <div style="background: var(--card-bg); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color);">
                    <div style="height: 220px; overflow: hidden; background: white;">
                        <img src="images/simulators/pid_overdamped.png" alt="Respuesta Sobreamortiguada" style="width: 100%; height: 100%; object-fit: contain;">
                    </div>
                    <div style="padding: 20px;">
                        <h4 style="color: #FF5252; margin-bottom: 10px;">Sobreamortiguado</h4>
                        <p style="font-size: 13px; color: #FF5252; line-height: 1.5;">
                            El sistema es lento. Se acerca al setpoint suavemente sin excederlo. Ocurre con mucha acción <strong>D</strong> o poca <strong>P</strong>. Seguro, pero ineficiente en tiempo.
                        </p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        <div class="container">
          <div class="footer-content">
            <div class="footer-info">
              <h3>Electromatics.com.ve</h3>
              <p>Innovación en Ingeniería Eléctrica y Automatización.</p>
              <div style="margin-top: 20px">
                <a href="https://youtube.com/@leonelgarcia4464" target="_blank" style="margin-right: 15px; font-size: 20px; color: #FF0000;"
                  ><i class="fa-brands fa-youtube"></i
                ></a>
                <a href="https://wa.me/5841658371322" target="_blank" style="margin-right: 15px; font-size: 20px; color: #25D366;"
                  ><i class="fa-brands fa-whatsapp"></i
                ></a>
                <a href="https://tiktok.com/@electrum69" target="_blank" style="margin-right: 15px; font-size: 20px; color: #000000;"
                  ><i class="fa-brands fa-tiktok"></i
                ></a>
                <a href="https://www.linkedin.com/in/leonel-garcía-0a1293b6" target="_blank" style="font-size: 20px; color: #0077b5;"
                  ><i class="fa-brands fa-linkedin"></i
                ></a>
              </div>
            </div>
            <div class="footer-links">
                <h4>Plataforma</h4>
                <a href="calculadora.html">Calculadora IA</a>
                <a href="normativa-electrica.html">Normativa 200-2009</a>
                <a href="uso-responsable-ia.html">Uso Responsable IA</a>
                <a href="formacion.html">Formación Técnica</a>
                <a href="proyectos.html">Proyectos</a>
            </div>
            <div class="footer-links">
                <h4>Empresa</h4>
                <a href="que-es-electromatics.html">Qué es Electromatics</a>
                <a href="para-quien-es.html">Para quién es</a>
                <a href="calculos-electricos.html">Servicios de Cálculo</a>
                <a href="contacto.html">Contacto</a>
            </div>
          </div>
          <div class="footer-bottom">
            <p style="margin-bottom: 10px; color: var(--text-secondary); opacity: 0.8; font-size: 14px;">
                Electromatics es una plataforma de apoyo al cálculo eléctrico. La responsabilidad técnica del uso de la información corresponde al usuario.
            </p>
            <p>&copy; 2025 Electromatics.com.ve. Todos los derechos reservados.</p>
          </div>
        </div>
    </footer>

    <script src="js/config.js"></script>
    <script src="js/simple-auth.js"></script>
    <script src="js/simulator-auth.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
             SimulatorAuth.init();
        });
    </script>
    <script src="js/simulators/pid.js?v=2.0"></script>
</body>
</html>
